pipeline {
    agent { label 'PythonNode' } // o docker
    environment { VENV_DIR = "venv" }
    stages {
        stage('Info Inicial') { steps { echo "Pipeline iniciado" } }
        stage('Crear entorno virtual') { steps { sh 'python3 -m venv venv' } }
        stage('Instalar dependencias') {
            steps {
                sh '''
                source venv/bin/activate
                pip install --upgrade pip
                pip install -r requirements.txt
                '''
            }
        }

        stage('Crear entorno virtual') {
            steps {
                sh 'python3 --version'
            }
        }

        stage('Instalar dependencias') {
            steps {
                sh '''
                source venv/bin/activate
                pip install --upgrade pip
                pip install -r requirements.txt
                '''
            }
        }

        stage('Ejecutar script Python') {
            steps {
                sh '''
                source venv/bin/activate
                python script.py
                '''
            }
        }
    }
    post {
        success { echo "Pipeline completado correctamente" }
        failure { echo "Pipeline fall√≥, revisar logs" }
    }
}
